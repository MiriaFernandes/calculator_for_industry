{% extends "base.html" %}

{% block title %}In√≠cio{% endblock %}
{% block styles %}
{{ super() }} {# Garante que os estilos do base.html tamb√©m sejam inclu√≠dos #}
<link rel="stylesheet" href="{{ url_for('static', filename='css/home.css') }}">
{% endblock %}

{% block header %}
<header class="absolute top-0 left-0 right-0 z-50 bg-transparent px-6 py-3  home-header">
    <!-- Menu desktop -->
    <nav class="flex items-center justify-between">
        <img src="/static/image/logotipo-mcm.svg" alt="Logo da Empresa" class="h-12 w-auto logo">

        <ul class="hidden lg:flex space-x-6 navbar-links">
            <li><a href="{{ url_for('index') }}">Dashboard</a></li>
            <li><a Href="{{ url_for('upload') }}">Upload Nota Fiscal</a></li>
            <li><a href="#">Cadastro Manual</a></li>
            <li><a href="#">Calculadora</a></li>
            <li><a href="{{ url_for('produto') }}">Produtos Finais</a></li>
            <li><a href="{{ url_for('listar_itens_view') }}">Mat√©rias-Primas</a></li>
        </ul>

        <div class="flex items-center space-x-4 login-icon">
            <svg id="open-modal-desktop" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6  hidden lg:block" fill="none"
                viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M5.121 17.804A9.004 9.004 0 0112 15c2.21 0 4.21.805 5.879 2.121M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
            </svg>

            <button id="menu-toggle" class="lg:hidden">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24"
                    stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                </svg>
            </button>
        </div>
    </nav>

    <!-- Menu mobile -->
    <nav id="mobile-menu"
        class="lg:hidden hidden fixed top-0 right-0 flex flex-col p-6 space-y-6 shadow-lg z-50 menu-mobile">
        <div class="flex justify-end">
            <button id="menu-close" class="text-2xl font-bold">
                &times;
            </button>
        </div>

        <div class="flex flex-col space-y-4 text-sm font-medium">
            <a href="#">Dashboard</a>
            <a href="#">Upload Nota Fiscal</a>
            <a href="#">Cadastro Manual</a>
            <a href="#">Calculadora</a>
            <a href="#">Produtos Finais</a>
            <a href="#">Mat√©rias-Primas</a>
            <a href="#" id="open-modal-mobile" class="hover:text-gray-300 font-semibold transition">Sign In</a>
        </div>
    </nav>
</header>
{% endblock %}

{% block content %}
<!-- {% block main_classes %}w-full{% endblock %} -->
<section class="relative w-full h-screen pt-20 bg-cover bg-center home">
    <!-- Overlay com gradiente escuro + vermelho -->
    <div class="absolute inset-0 bg-gradient-to-r from-black via-black/80 to-transparent"></div>

    <!-- Conte√∫do da hero -->
    <div class="relative z-10 flex flex-col justify-center h-full px-6 lg:pl-24 ">
        <div class="max-w-xl hero-content text-left">
            <h1 class="text-4xl sm:text-5xl leading-tight mb-4">
                Calculadora <br /> de Custo
            </h1>
            <p class=" mb-6">
                Descubra o verdadeiro custo da mat√©ria-prima que comp√µe sua <br />
                produ√ß√£o e ajuste sua estrat√©gia de pre√ßos.
            </p>
            <button href="#" class="home-button">
                CALCULAR
            </button>
        </div>
    </div>
</section>


<section class="relative mx-[calc(50%-50vw)] w-[100vw] overflow-x-clip py-10 sm:py-12 bg-transparent calc-container">
    <div class="px-4 sm:px-6">
        <div class="ring-1 bg-white rounded-xl shadow calc-content">
            <header class="flex items-center justify-between gap-4 p-4 sm:p-7">
                <div class="flex items-center gap-3 sm:gap-4">
                    <img src="/static/image/illustration-calc (1).svg" alt="Mascote da Calculadora"
                        class="h-16 sm:h-20 md:h-24 lg:h-28 w-auto shrink-0" />
                </div>

                <button type="button"
                    class="btn-materia-prima inline-flex items-center gap-2 text-xs uppercase tracking-wide hover:text-neutral-800 focus:outline-none focus-visible:ring-2  ">
                    <p>Adicionar mat√©ria-prima</p>
                    <span><img src="/static/image/icon-plus.svg" alt="√çcone de adicionar" /></span>
                </button>
            </header>

            <!-- Tabela de insumos selecionados -->
            <div class="overflow-x-auto px-5 sm:px-7 mb-10">
                <table id="selecionadosTable" class="min-w-full border border-gray-300 text-sm">

                    <tbody>
                        <div id="manualCards" class="px-5 sm:px-7 mb-10 space-y-4">
                            <!-- Os cards aparecer√£o aqui -->
                            <!-- <td colspan="6" class="card-line">
                                <div class="card">
                                    <div class="card-content">

                                        <p>C√≥digo</p>
                                        <p>Nome</p>
                                        <p>Unidade</p>
                                        <p>Quantidade</p>
                                        <p>Valor unit√°rio</p>
                                        <p >Subtotal</p>
                                        <p>000458</p>
                                        <p id="card-content-nome">papel kraft 0,30mmx1000mm</p>
                                        <p>KG</p>
                                        <input type="number" inputmode="decimal" lang="pt-BR" step="0.0001" min="0"
                                            value="${ins.quantidade ?? 1}" data-id="${ins.id}" class="quantidade-input">
                                        <p>R$ 30,00</p>

                                        <p data-subtotal>${fmt(subtotal)}</p>

                                    </div>
                                </div>
                                <button class="btn btn-primary " data-rm="${ins.id}" type="button"><img src="../static/image/icon-close-calc.svg" alt=""></button>
                            </td> -->
                            
                        </div>
                        <!-- Linhas renderizadas via JS -->
                    </tbody>
                </table>
            </div>
            <!-- üîò Bot√£o externo que abre o modal -->
            <div class="px-5 sm:px-7 mb-10">
                <button id="abrirSalvarModal"
                    class="bg-red-600 text-white px-6 py-2 rounded hover:bg-red-700 transition font-semibold w-full sm:w-auto">
                    Salvar Produto
                </button>
                <div class="text-lg font-semibold text-red-600">
                    Total: <span id="totalValor">R$ 0,00</span>
                </div>
            </div>

            <!-- üîê Modal de salvar produto -->
            <!-- üîê Modal de salvar produto -->
            <div id="modal-salvar-produto"
                class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                <div class="bg-white w-[90%] max-w-xl p-6 rounded-lg shadow-lg relative">

                    <!-- ‚ùå Bot√£o de fechar -->
                    <button id="close-salvar-modal"
                        class="absolute top-2 right-2 text-xl font-bold text-gray-700 hover:text-gray-900">
                        &times;
                    </button>

                    <!-- üßæ Cabe√ßalho -->
                    <h2 class="text-lg font-semibold mb-6">Salvar Produto</h2>

                    <!-- Nome do produto + total -->
                    <div class="flex flex-col sm:flex-row justify-between items-center gap-6 mb-6">
                        <input id="nomeProduto" type="text" placeholder="Nome do produto"
                            class="border border-gray-300 rounded px-4 py-2 w-full sm:w-1/2" />

                    </div>

                    <!-- Bot√£o interno que realmente salva -->
                    <div>
                        <button id="btnSalvarProduto"
                            class="bg-red-600 text-white px-6 py-2 rounded hover:bg-red-700 transition font-semibold w-full sm:w-auto">
                            Salvar Produto
                        </button>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <!-- üîê Modal de mat√©ria-prima com busca e formul√°rio -->
    <div id="modal-materia-prima"
        class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white w-[90%] max-w-2xl p-6 rounded-lg shadow-lg relative max-h-[90vh] overflow-y-auto">

            <!-- ‚ùå Bot√£o de fechar -->
            <button id="close-modal" class="absolute top-2 right-2 text-xl font-bold text-gray-700 hover:text-gray-900">
                &times;
            </button>

            <!-- üßæ Cabe√ßalho -->
            <h2 class="text-lg font-semibold mb-4">Adicionar Mat√©ria-Prima</h2>

            <!-- üîç Barra de busca -->
            <div class="flex items-center gap-4 mb-6">
                <input id="searchInput" type="text" placeholder="Buscar mat√©ria-prima..."
                    class="border border-gray-300 rounded px-4 py-2 w-full" />
                <button id="clearSearch" class="text-sm text-red-600 hover:underline">Limpar</button>
            </div>

            <!-- üì¶ Lista de insumos dispon√≠veis -->
            <div id="itensList" class="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-6">
                <!-- Insumos renderizados via JS -->
            </div>




        </div>
    </div>
</section>


{% endblock %}

{% block scripts %}
<script type="module" src="{{ url_for('static', filename='js/pages/produto.js') }}"></script>
{% endblock %}